PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> PREFIX pq: <http://www.wikidata.org/prop/qualifier/> PREFIX ps: <http://www.wikidata.org/prop/statement/> PREFIX p: <http://www.wikidata.org/prop/> PREFIX wdt: <http://www.wikidata.org/prop/direct/> PREFIX wd: <http://www.wikidata.org/entity/>  SELECT (SAMPLE(?seasonNumber) AS ?seasonNumber) (SAMPLE(?episodeNumber) AS ?episodeNumber) (SAMPLE(?title) AS ?title) (MIN(?pubDate) AS ?pubDate) ?episode {      ?episode wdt:P31 wd:Q21191270;            wdt:P179 wd:Q321423.      OPTIONAL {     ?episode p:P179 [              ps:P179/p:P179 [         ps:P179 wd:Q321423;                 pq:P1545 ?seasonNumber       ] ;       pq:P1545 ?episodeNumber     ]   }   OPTIONAL { ?episode wdt:P1476 ?title. }   OPTIONAL { ?episode wdt:P577 ?pubDate. } } GROUP BY ?episode  ORDER BY IF(BOUND(?seasonNumber), xsd:integer(?seasonNumber), 1000) xsd:integer(?episodeNumber) ?title 